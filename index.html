<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>뜰팁장터 운세 뽑기</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,'Noto Sans KR',sans-serif;
  background:#f6e7cc;
}

/* 위아래 이미지 */
.top-bg,
.bottom-bg{
  width:100%;
  display:block;
}

/* 둥둥 애니메이션 */
.float{
  animation:float 3s ease-in-out infinite;
}

@keyframes float{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
}

/* 카드 영역 */
.card-wrap{
  display:flex;
  justify-content:center;
  padding:60px 20px;
}

/* 카드 */
.card{
  width:100%;
  max-width:700px;
  background:white;
  padding:60px 40px;
  border-radius:30px;
  text-align:center;
  box-shadow:0 20px 50px rgba(0,0,0,0.15);
}

/* 텍스트 */
h1{
  margin:0 0 15px;
  font-size:38px;
}

.desc{
  color:#777;
  font-size:18px;
}

/* 버튼 */
button{
  margin-top:40px;
  width:100%;
  padding:24px;
  border:none;
  border-radius:20px;
  background:linear-gradient(135deg,#ff4d4d,#ff9f1a);
  color:white;
  font-size:22px;
  font-weight:700;
  cursor:pointer;
  transition:.2s;
}

button:hover{
  transform:scale(1.05);
}

button:disabled{
  background:#ccc;
  cursor:not-allowed;
}

.result{
  margin-top:30px;
  font-size:30px;
  font-weight:900;
}

.sub{
  margin-top:12px;
  font-size:20px;
}
</style>
</head>

<body>

<!-- 위 이미지 -->
<img src="top.png" class="top-bg float">

<!-- 운세 카드 -->
<div class="card-wrap">
  <div class="card">
    <h1>설날 운세 뽑기</h1>
    <div class="desc">선착순 250명 중 당첨! (기기당 1회)</div>

    <button id="drawBtn">운세 뽑기</button>

    <div id="result" class="result"></div>
    <div id="sub" class="sub"></div>
  </div>
</div>

<!-- 아래 이미지 -->
<img src="bottom.png" class="bottom-bg float">

<script>
const STORAGE_KEY = "fortune_2026_once";

const btn = document.getElementById("drawBtn");
const result = document.getElementById("result");
const sub = document.getElementById("sub");

/* 페이지 들어오자마자 참여 여부 체크 */
if(localStorage.getItem(STORAGE_KEY)){
  btn.disabled = true;
  btn.innerText = "이미 참여함";
  result.innerText = "이미 참여했습니다!";
  sub.innerText = "기기당 1회 이벤트입니다.";
}

/* 뽑기 */
btn.onclick = async ()=>{

  // 이미 참여했으면 막기
  if(localStorage.getItem(STORAGE_KEY)){
    alert("이미 참여했습니다!");
    return;
  }

  btn.disabled = true;
  btn.innerText = "뽑는 중...";

  try{
    const res = await fetch("/api/draw");
    const data = await res.json();

    result.innerText = data.title || "오류";
    sub.innerText = data.desc || "";

    // ⭐ 기기당 1회 제한 저장
    localStorage.setItem(STORAGE_KEY, "true");_
